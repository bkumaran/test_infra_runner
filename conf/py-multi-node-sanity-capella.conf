# Query
tuqquery.tuq_capella_provisioned.QueryProvisionedTests:
   test_create_scope,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_insert,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_primary_scan,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_prepare_statement,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_inline_udf,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_transaction,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_aggregate,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_join,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_cte,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_advise,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_advisor,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_index_scan,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_index_scan_covered,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_array_index,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True
   test_update_statistics,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,skip_load=True


# Eventing Tests
eventing.eventing_sanity.EventingSanity:
    test_create_mutation_for_dcp_stream_boundary_from_beginning,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,non_default_collection=True,java_sdk_client=True,force_deploy_cluster=True
    # Disabling for now as further debugging is needed
    # test_delete_mutation_for_dcp_stream_boundary_from_beginning,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,non_default_collection=True,java_sdk_client=True
    test_update_mutation_for_dcp_stream_boundary_from_now,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,non_default_collection=True,java_sdk_client=True
    test_n1ql_query_execution_from_handler_code,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,non_default_collection=True,java_sdk_client=True
    test_timer_events_from_handler_code_with_bucket_ops,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,non_default_collection=True,java_sdk_client=True
    test_delete_bucket_operation_from_handler_code,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,non_default_collection=True,java_sdk_client=True
    test_cancel_timers_with_timers_being_overwritten,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,java_sdk_client=True
    test_source_bucket_mutations_with_timers,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,source_bucket_mutation=true,java_sdk_client=True
    test_source_doc_mutations,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,source_bucket_mutation=true,java_sdk_client=True
    test_source_bucket_mutation_for_dcp_stream_boundary_from_now,nodes_init=4,services_init=kv-kv-eventing-index:n1ql,source_bucket_mutation=true,java_sdk_client=True

#FTS tests
fts.stable_topology_fts.StableTopFTS:

  create_simple_default_index,items=10000,cluster=D,F,D,GROUP=P0;COLLECTIONS;MULTIPLE_CA;CAPELLA
  create_simple_default_index,items=10000,update=True,upd_del_fields=['is_manager','dept','manages.team_size'],GROUP=PS;COLLECTIONS;MULTIPLE_CA;CAPELLA
  create_simple_default_index,items=10000,delete=True,GROUP=PS;COLLECTIONS;CAPELLA
  create_simple_default_index,items=10000,update=True,delete=True,GROUP=P0;COLLECTIONS;MULTIPLE_CA;CAPELLA
  create_simple_default_index,items=20000,index_replicas=1,max_partitions_pindex=1024,cluster=D+F,GROUP=P1;COLLECTIONS;MULTIPLE_CA;CAPELLA
  create_simple_default_index,items=20000,index_replicas=1,max_partitions_pindex=1,GROUP=P1;COLLECTIONS;CAPELLA

  delete_index_then_query,items=30000,cluster=D,F,F,GROUP=P0;COLLECTIONS
  index_wiki,items=20000,lang=ES,analyzer=es,cluster=D+F,F,F,GROUP=P1;COLLECTIONS;MULTIPLE_CA;CAPELLA
  run_default_index_query,items=1000,query="""{"match": "safiya@mcdiabetes.com", "field": "email"}""",expected_hits=1000,GROUP=PS;COLLECTIONS;MULTIPLE_CA;CAPELLA
  run_default_index_query,items=1000,update=True,upd=100,query="""{"min": 1, "max":1, "field": "mutated", "inclusive_min": true, "inclusive_max": true}""",expected_hits=1000,GROUP=P0;COLLECTIONS;CAPELLA
  test_query_type,items=10000,num_queries=100,query_type=match,prefix,phrase,bool,match_phrase,conjunction,disjunction,date_range,numeric_range,GROUP=PS;COLLECTIONS;CAPELLA
  test_match_all,items=10000,GROUP=P0;COLLECTIONS;CAPELLA
  test_match_none,items=10000,GROUP=P0;COLLECTIONS;CAPELLA
  test_match_consistency,update=True,consistency_level=at_plus,consistency_vectors="""{"default_index_1": {"1": 8}}""",GROUP=P1;COLLECTIONS;MULTIPLE_CA;CAPELLA
  test_match_consistency,update=True,upd_del_fields=['is_manager','dept','manages.team_size'],consistency_level=at_plus,consistency_vectors="""{"default_index_1": {"13": 10}}""",GROUP=P1;COLLECTIONS;MULTIPLE_CA;CAPELLA

  index_query_custom_mapping,items=1000,custom_map=True,cm_id=6,num_queries=100,compare_es=False,run_as_user=Administrator,GROUP=CAPELLA
  test_create_drop_index,items=10,java_sdk_client=True,quota_percent=20,GROUP=CAPELLA



# 3 kv,index,n1ql and add 1 kv,index,n1ql
rebalance.rebalancein.RebalanceInTests.rebalance_in_with_ops,nodes_init=3,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,nodes_in=1,services_in=kv:index:n1ql,replicas=1,items=1000,force_deploy_cluster=True,doc_ops=create;update;delete
# 4 kv,index,n1ql and remove 1 kv,index,n1ql
rebalance.rebalanceout.RebalanceOutTests.rebalance_out_with_ops,nodes_init=4,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql-kv:index:n1ql,nodes_out=1,replicas=1,items=1000,servers=4,force_deploy_cluster=True
# 3 kv,index,n1ql, 2 eventing and add 1 eventing, remove all eventing
eventing.eventing_rebalance.EventingRebalance.test_eventing_rebalance_in_when_existing_eventing_node_is_processing_mutations,nodes_init=5,services_init=kv:index:n1ql-kv:index:n1ql-kv:index:n1ql-eventing-eventing,nodes_in=1,services_in=eventing,dataset=default,groups=simple,reset_services=True,doc-per-day=1,force_deploy_cluster=True,GROUP=bucket_op;bucket_op_windows
# 3 kv,fts and add 1 kv,fts
fts.moving_topology_fts.MovingTopFTS.rebalance_in_during_index_building,items=100,cluster=D+F,D+F,D+F,GROUP=P0,validate_index_partition=False
#GSI sanity tests
gsi.collections_index_basics.CollectionsIndexBasics:
    test_create_primary_index_for_collections,default_bucket=false,force_clean=true,defer_build=False,GROUP=P0,nodes_init=2,services_init=kv:n1ql:index-index
    test_create_primary_index_for_collections,default_bucket=false,force_clean=true,defer_build=True,GROUP=P0,nodes_init=2,services_init=kv:n1ql:index-index
    test_gsi_for_collection,default_bucket=false,force_clean=true,defer_build=False,GROUP=P0,nodes_init=2,services_init=kv:n1ql:index-index
    test_gsi_for_collection,default_bucket=false,force_clean=true,defer_build=True,GROUP=P0,nodes_init=2,services_init=kv:n1ql:index-index
    test_multiple_indexes_on_same_field,default_bucket=false,force_clean=true,defer_build=False,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_gsi_indexes_with_WITH_clause,default_bucket=false,force_clean=true,defer_build=True,nodes_init=2,services_init=kv:n1ql:index-kv:n1ql:index,GROUP=EE_ONLY;P1
    test_gsi_indexes_with_WITH_clause,default_bucket=false,force_clean=true,defer_build=False,nodes_init=2,services_init=kv:n1ql:index-kv:n1ql:index,GROUP=EE_ONLY;P1
    test_gsi_array_indexes,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_gsi_array_indexes,default_bucket=false,defer_build=True,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_index_partitioning,default_bucket=false,defer_build=False,skip_load=True,nodes_init=2,services_init=kv:n1ql:index-kv:n1ql:index,GROUP=EE_ONLY;P1
    test_index_partitioning,default_bucket=false,defer_build=True,skip_load=True,nodes_init=2,services_init=kv:n1ql:index-kv:n1ql:index,GROUP=EE_ONLY;P1
    test_partial_indexes,default_bucket=false,defer_build=True,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_partial_indexes,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_mutations_for_persistent_snapshot,default_bucket=false,skip_load=True,GROUP=P0,nodes_init=2,services_init=kv:n1ql:index-index
    test_indexes_with_deferred_build,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1;KV_DGM,nodes_init=2,services_init=kv:n1ql:index-index
    test_drop_indexes_scenarios_with_dgm,default_bucket=false,defer_build=False,skip_load=True,nodes_init=2,services_init=kv:n1ql:index-kv:n1ql:index,reset_services=True,nodes_init=2,services_init=kv:n1ql:index-index,GROUP=P1;KV_DGM
    test_drop_indexes_scenarios,default_bucket=false,defer_build=False,skip_load=True,nodes_init=2,services_init=kv:n1ql:index-kv:n1ql:index,reset_services=True,GROUP=P1;KV_DGM
    test_create_negative_scenarios,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_build_scenarios,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1;KV_DGM,nodes_init=2,services_init=kv:n1ql:index-index
    test_drop_negative_scenarios,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index
    test_build_multiple_index_concurrently_across_collections,default_bucket=false,skip_load=True,GROUP=P1;KV_DGM,num_scopes=5,num_collections=2,nodes_init=2,services_init=kv:n1ql:index-index
    test_same_name_indexes,default_bucket=false,defer_build=False,skip_load=True,GROUP=P1,nodes_init=2,services_init=kv:n1ql:index-index

    test_index_creation_with_keyspace_delete,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P0
    test_index_creation_with_keyspace_delete,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P0
    test_index_creation_with_keyspace_delete,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P0
    test_index_during_scan_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P0
    test_index_during_scan_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P0
    test_index_during_scan_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P0
    test_index_during_scan_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=True,item_to_delete=bucket,GROUP=P1
    test_index_during_scan_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=True,item_to_delete=scope,GROUP=P1
    test_index_during_scan_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=True,item_to_delete=collection,GROUP=P1
    test_drop_index_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P1
    test_drop_index_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1
    test_drop_index_with_delete_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P1
    test_delete_bsc_while_index_updates_mutation,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P1
    test_delete_bsc_while_index_updates_mutation,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1
    test_delete_bsc_while_index_updates_mutation,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P1
    test_delete_multiple_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,bucket_size=150,GROUP=P1
    test_delete_multiple_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,bucket_size=150,GROUP=P1
    test_delete_multiple_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,bucket_size=150,GROUP=P1
    test_delete_bsc_with_flush_running,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P1
    test_delete_bsc_with_flush_running,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1
    test_delete_bsc_with_flush_running,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P1
    test_delete_bsc_with_only_deferred_Index,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P1
    test_delete_bsc_with_only_deferred_Index,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1
    test_delete_bsc_with_only_deferred_Index,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P1
    test_delete_recreate_collection_indexes,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=bucket,GROUP=P1
    test_delete_recreate_collection_indexes,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1
    test_delete_recreate_collection_indexes,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P1
    test_delete_deleted_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1
    test_delete_deleted_bsc,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=collection,GROUP=P1
    test_delete_multiple_collections_with_indexes,default_bucket=false,force_clean=true,defer_build=False,item_to_delete=scope,GROUP=P1,num_scopes=5,num_collections=2
